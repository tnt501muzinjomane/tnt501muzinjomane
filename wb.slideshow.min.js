/*
 * jQuery Slideshow Plugin for WYSIWYG Web Builder v8.x
 * Copyright Pablo Software solutions 2012
 * http://www.wysiwygwebbuilder.com/
 */
(function(a){a.fn.slideshow=function(d){return this.each(function(){a.slideshow(this,d)})};a.slideshow=function(d,b){var c={effect:"none",effectlength:2E3,easing:"linear",direction:"",interval:2E3,type:"sequence",dataSource:"local",param:null,maxItems:10,current:1,last:0};if(b&&"string"==typeof b)"nextimage"==b?a.slideshow.nextimage(d):"previmage"==b&&a.slideshow.previmage(d);else if(b&&(state=a.extend(c,b)),"local"==state.dataSource)a.slideshow.init(d,state);else if("flickr"==state.dataSource){$container=
a(d);$container.empty();var e=a("<img/>").attr({src:"wb.slideshow.gif",alt:"Loading. Please wait."}).addClass("slideshow-wait").appendTo($container),c="http://api.flickr.com/services/feeds/photos_public.gne?format=json&";null!=state.param&&(c+=state.param,c+="&");a.getJSON(c+"jsoncallback=?",function(b){e.remove();a.each(b.items,function(b,d){a("<img>").attr("src",d.media.m).css("left","0").css("top","0").appendTo($container);if(b==state.maxItems)return!1});a.slideshow.init(d,state)})}};a.slideshow.init=
function(d,b){b.images=a(d).find("img").get();a.each(b.images,function(d){a(b.images[d]).css("zIndex",b.images.length-d).css("position","absolute").css("top","0").css("left","0")});a(d).data("state",b);var c=b.interval;"kenburns"==b.effect&&(c=1);0!=c&&setTimeout(function(){a.slideshow.imagetransition(d)},c)};a.slideshow.nextimage=function(d){state=a(d).data("state");state.interval=0;a.slideshow.next(state);a.slideshow.imagetransition(d)};a.slideshow.previmage=function(d){state=a(d).data("state");
state.interval=0;0<=state.current-1?(state.current-=1,state.last=state.current+1):(state.current=state.images.length-1,state.last=0);a.slideshow.imagetransition(d)};a.slideshow.blockEffectStep1=function(d,b,c,e){b<d.length?a(d[b]).animate({opacity:1},c,"linear",function(){a.slideshow.blockEffectStep1(d,b+1,c,e)}):"function"==typeof e&&e.call()};a.slideshow.blockEffectStep2=function(d,b,c,e){b<d.length?a(d[b]).animate({opacity:0},c,"linear",function(){a.slideshow.blockEffectStep2(d,b+1,c,e)}):"function"==
typeof e&&e.call()};a.slideshow.next=function(a){if("sequence"==a.type)a.current+1<a.images.length?(a.current+=1,a.last=a.current-1):(a.current=0,a.last=a.images.length-1);else if("random"==a.type)for(a.last=a.current;a.current==a.last;)a.current=Math.floor(Math.random()*a.images.length)};a.slideshow.imagetransition=function(d){state=a(d).data("state");if("blocks"!=state.effect){for(var b=0;b<state.images.length;b++)a(state.images[b]).css("display","none");a(state.images[state.last]).css("display",
"block").css("zIndex","0")}if("none"==state.effect)a(state.images[state.current]).css("zIndex","1").show(),a(state.images[state.last]).css("display","none");else if("fade"==state.effect)a(state.images[state.current]).css("zIndex","1").fadeIn(state.effectlength);else if("slide"==state.effect)a(state.images[state.current]).css("zIndex","1").show("slide",{direction:state.direction,easing:state.easing},state.effectlength);else if("puff"==state.effect)a(state.images[state.current]).css("zIndex","1").show("puff",
{easing:state.easing},state.effectlength);else if("blind"==state.effect)a(state.images[state.current]).css("zIndex","1").show("blind",{direction:state.direction,easing:state.easing},state.effectlength);else if("clip"==state.effect)a(state.images[state.current]).css("zIndex","1").show("clip",{direction:state.direction,easing:state.easing},state.effectlength);else if("drop"==state.effect)a(state.images[state.current]).css("zIndex","1").show("drop",{direction:state.direction,easing:state.easing},state.effectlength);
else if("fold"==state.effect)a(state.images[state.current]).css("zIndex","1").show("fold",{easing:state.easing},state.effectlength);else if("kenburns"==state.effect){var b=a(d).outerWidth(),c=a(d).outerHeight(),e=Math.ceil(b/10),g=b,f=c,i=Math.floor(4*Math.random()),k=Math.floor(2*Math.random()),j=1;g<b+e?j=f<c+e?Math.max((c+e)/f,(b+e)/g):(b+e)/g:f<c+e&&(j=(c+e)/f);g*=j;f*=j;0==i||3==i?(leftStart=-e,leftEnd=b-g+e):(leftStart=b-g+e,leftEnd=-e);1==i||3==i?(topStart=-e,topEnd=c-f+e):(topStart=c-f+e,
topEnd=-e);1==k?(widthStart=1.2*g,widthEnd=g,heightStart=1.2*f,heightEnd=f):(widthStart=g,widthEnd=1.2*g,heightStart=f,heightEnd=1.2*f);a(state.images[state.current]).css("display","block").css("zIndex","1").css({opacity:0,position:"absolute",left:Math.ceil(leftStart),top:Math.ceil(topStart),width:Math.ceil(widthStart),height:Math.ceil(heightStart)}).animate({opacity:1},2E3).animate({left:Math.ceil(leftEnd),top:Math.ceil(topEnd),width:Math.ceil(widthEnd),height:Math.ceil(heightEnd)},{duration:state.effectlength,
queue:!1}).css({width:b,height:c})}else if("zoom"==state.effect)c=a(state.images[state.last]).outerWidth(),e=a(state.images[state.last]).outerHeight(),b={top:0,left:0,width:c,height:e},c={width:0,height:0,top:e/2,left:c/2},a(state.images[state.current]).animate(c,0,null),a(state.images[state.current]).css("display","block").css("zIndex","1"),a(state.images[state.current]).animate(b,state.effectlength,null);else if("zoominout"==state.effect)c=a(state.images[state.last]).outerWidth(),e=a(state.images[state.last]).outerHeight(),
b={top:0,left:0,width:c,height:e},c={width:0,height:0,top:e/2,left:c/2},a(state.images[state.last]).animate(c,state.effectlength,null),a(state.images[state.current]).animate(c,0,null),a(state.images[state.current]).css("display","block").css("zIndex","1"),a(state.images[state.current]).animate(b,state.effectlength,null);else{if("blocks"==state.effect){c=a(state.images[state.last]).outerWidth()/5;e=a(state.images[state.last]).outerHeight()/5;a(state.images[state.current]).parent().append('<div style="position:absolute;left:0px;top:0px;z-index:'+
state.images.length+'" id="block-effect"></div>');for(var h=[],b=0;25>b;b++)h[b]="#block-"+b,a("#block-effect").append('<div style="float:left;background-color:#000000;width:'+c+"px;height:"+e+'px;opacity:0.00;-moz-opacity:0.00;-khtml-opacity:0.00;filter:alpha(opacity=0)" id="block-'+b+'"></div>');b=h.length;if(0!=b)for(;--b;)c=Math.floor(Math.random()*(b+1)),e=h[b],h[b]=h[c],h[c]=e;a.slideshow.blockEffectStep1(h,0,50,function(){for(var b=0;b<state.images.length;b++)a(state.images[b]).css("display",
"none");a(state.images[state.last]).css("display","block").css("zIndex","0");a(state.images[state.current]).css("zIndex","1").show();a.slideshow.blockEffectStep2(h,0,50,function(){a("#block-effect").remove();0!=state.interval&&setTimeout(function(){a.slideshow.next(state);a.slideshow.imagetransition(d)},state.interval)})});return}a(state.images[state.current]).css("zIndex","1").show(state.effect,{},state.effectlength)}0!=state.interval&&(a.slideshow.next(state),setTimeout(function(){a.slideshow.imagetransition(d)},
state.interval))}})(jQuery);